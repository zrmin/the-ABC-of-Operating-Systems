<h1><center>一、操作系统概述</center></h1>

1.1 操作系统的概念、特征、功能和服务

1.1.1 操作系统概念

OS是系统软件，程序模块的集合，资源管理和用户接口功能



操作系统的目标（不同视角）：

* 方便性（用户的观点）

提供良好的、一致的用户接口，弥补硬件系统的类型和数量差别，使计算机更容易使用

* 有效性（系统管理人员的观点）

使CPU、I/O设备和存储空间得到有效利用；管理和分配软、硬件资源，合理地组织计算机的工作流程

* 可扩充性

OS应采用层次化结构，以便于增加新的功能层次和模块，并能修改老的功能层次和模块

* 开放性

遵循标准规范，方便地实现互联，实现应用的可移植性和互操作性



1. OS作为用户与计算机硬件系统间的接口

* OS处于用户与计算机硬件系统之间，用户通过OS来使用计算机系统
* 系统方式（命令接口）
  * 命令行
  * 菜单式
  * 命令脚本式
* 系统调用（程序接口）
  * 形式上类似于过程调用
  * 在应用编程中使用
* 图形用户接口
  * 图形、窗口等

2. OS作为计算机系统资源的管理者

* 计算机的硬件资源包括处理机、存储器、I/O设备及数据和程序等
* 管理的内容：资源的当前状态（数量和使用情况）、资源的分配、回收和访问操作，相应的管理策略（包括用户权限）
  * CPU管理
  * 存储器管理
  * I/O设备管理
  * 文件管理

3. OS用作扩充机器

* OS是扩展机（extended machine）/虚拟机（virtual machine）
  * 将覆盖了软件的机器成为扩展机或虚拟机
* 在裸机上添加：设别管理、文件管理、存储管理（针对内存和外存）、CPU管理
* 合理组织工作流程：作业管理、进程管理

<font color = red>操作系统的非形式化定义（关键点）：系统软件，程序模块的集合，资源管理和用户接口功能</font>



1.1.2 操作系统的基本特征

* 并发性（Concurrence）
* 共享（Sharing）
* 虚拟（Virtual）
* 异步性（Asynchronism）

（注意：这里指的是通用操作系统）

并发：

* 并发指的是多个事件在<font color=blue>同一时间段内</font>发生。操作系统是一个并发系统，各进程间的并发，系统与应用间的并发。操作系统要完成这些并发过程的管理
* 并行parallel是指在<font color=blue>同一时刻</font>发生
* 在多道程序处理时，宏观上并发，微观上交替执行（在单处理器情况下）
* 程序的静态实体是可执行文件，而动态实体是进程（或称作任务），并发指的是进程（或线程）

（注意：区分并发和并行）

共享：

* 是指系统中的资源可供内存中多个并发执行的进程（线程）共同使用。因资源属性不同，对资源共享的方式也不同
* 互斥共享（如音频设备、打印机等）
  * 资源分配后释放前，不能被其他进程所用
* 同时访问（如可重入代码，磁盘文件）
  * 同时是宏观上，在微观上进程可能是交替地对资源进行访问

（注意：并发和共享是相互依存的）

* 并发和共享是操作系统的两个最基本的特征
  * 一方面，资源共享是以程序（进程）的并发执行为条件的
  * 另一方面，若系统不能对资源共享实施有效管理，协调好诸进程对共享资源的访问，也必然影响到程序并发执行的程度

虚拟性：

* 通过某种技术把一个物理实体变为若干个逻辑上的对应物，提高资源的利用率
  * CPU——每个用户（进程）的“虚处理机”——PCB
  * 存储器——每个进程都占有的地址空间（指令+数据+堆栈）
  * 显示设备——多窗口或虚拟终端（virtual terminal）
  * 打印设备——将临界资源变为同时访问资源

异步性：

* 不确定性：进程的执行顺序和执行时间的不确定性
  * 进程的运行速度不可预知：分时系统中，多个进程并发执行，“时走时停”，不可预知每个进程的运行推进快慢
* 判据：无论快慢，应该结果相同——通过进程互斥和同步手段来保证
  * 难以重现系统在某个时刻的状态（包括重现运行中的错误）
* 性能保证：实时系统与分时系统相似，但通过资源预留以保证性能



1.1.3 操作系统的主要功能

* CPU管理
* 存储器管理
* 设备管理
* 文件管理
* 用户管理



CPU管理

* 完成CPU资源的分配、回收调度等功能
* CPU调度的单位可为进程或线程
* 进程控制
  * 创建、撤销、挂起、改变运行优先级等
* 进程同步
  * 协调并发进程之间的推进步骤，以协调资源共享
  * 互斥方式，诸进程访问临界资源时采用这种方式
  * 同步方式，在相互合作完成任务的进程之间由同步机构对执行次序加以协调

* 进程通信
  * 负责进程之间传送数据，以协调进程间的协作
  * 如，输入进程、计算进程、打印进程之间的通信
* 进程调度
  * 作业和进程的运行切换，以充分利用CPU资源和提高系统性能
  * 作业调度从外存调入内存
  * 进程协调是从内存中的进程就绪队列中选一个分配CPU
  * 在多线程OS中，要考虑线程调度
  * 考虑同一类型内的公平性、高效率（吞吐量大）、作业或进程的周转时间等

存储器管理

* 管理目标
  * 提高利用率、方便用户使用、提供足够大的存储空间、方便进程并发执行
* 内存分配
  * 为每道程序分配空间：静态分配、动态分配
  * 提高利用率
  * 允许正在运行程序申请附加空间
* 内存保护
  * 确保每道用户程序都只在自己的内存空间内运行、互不干扰
  * 如：访问合法性检查、甚至要防止从“垃圾”中窃取其他进程的信息
  * 一种方法是设置两个界限寄存器，由硬件实现越界检查
* 地址映射
  * 程序中的地址成为“逻辑地址”或“相对地址”
  * 内存中单元的地址成为“物理地址”
  * 多道程序下，进程装入内存后要由逻辑地址到内存物理地址进行变换
* 内存扩充
  * 借助于虚拟存储技术，从逻辑上去扩充内存容量
  * 改善了系统的性能，基本上不增加硬件投资
  * 请求调入功能
  * 置换功能

设备管理

* 管理目标
  * 方便的设备使用、提高CPU与I/O设备利用率、提高I/O速度
* 缓冲区管理
  * 匹配CPU和外设的速度，提高两者的利用率
  * 单缓冲、双缓冲、公共缓冲池
* 设备分配与回收
  * 在多用户间共享I/O设备资源
  * 针对不同类型设备采用不同策略，如独占设备分配
  * 虚拟设备（virtual device）：设备由多个进程共享，每个进程如同独占
* 设备独立性
  * 用户申请的设备与实际操作的物理设备无关

文件管理

* 管理目标
  * 